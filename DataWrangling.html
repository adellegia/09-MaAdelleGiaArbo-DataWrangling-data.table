<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data Wrangling at Scale with data.table</title>

<script src="DataWrangling_files/header-attrs-2.11/header-attrs.js"></script>
<script src="DataWrangling_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="DataWrangling_files/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="DataWrangling_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="DataWrangling_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="DataWrangling_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="DataWrangling_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="DataWrangling_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="DataWrangling_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="DataWrangling_files/navigation-1.1/tabsets.js"></script>
<link href="DataWrangling_files/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="DataWrangling_files/pagedtable-1.1/js/pagedtable.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Data Wrangling at Scale with data.table</h1>

</div>


<p>This presentation will detail data.tables data wrangling functionality, including:</p>
<ul>
<li>Manipulating data</li>
<li>Modifying variables</li>
<li>Summarizing data</li>
<li>Chaining</li>
<li>Joining</li>
<li>Plotting data</li>
</ul>
<p>We will end the presentation with an exercise.</p>
<div id="whats-data-wrangling" class="section level1">
<h1>What’s data wrangling? 🤔</h1>
<p>Data wrangling is the process of converting raw data to another format which can be readily analyzable.</p>
<p><img src="pics/data_wrangling.png" width="40%" style="display: block; margin: auto;" /></p>
</div>
<div id="data.table" class="section level1">
<h1>data.table 📸</h1>
<p><code>data.table</code> provides an efficient and high performance alternative of base R’s data.frame when conducting data wrangling.</p>
<p><code>data.table</code> enables this efficiency by providing:</p>
<ul>
<li>concise syntax: fast to type, fast to read</li>
<li>fast speed</li>
<li>memory efficiency</li>
<li>a large community</li>
<li>rich features</li>
</ul>
<p>To install the package, we use <code>install.packages('data.table')</code>.</p>
<div id="importing-with-fread" class="section level2">
<h2>Importing with <code>fread()</code></h2>
<p><code>data.table</code>’s efficiency begins from the outset with <code>fread()</code>, which is short for fast read is data.table’s version of <code>read_csv()</code>.</p>
<p>Let’s import and read the <code>mtcars</code> dataset and call it <code>mt</code> using <code>fread()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;mtcars.csv&quot;</span>)</span></code></pre></div>
<p>Let’s check how fast <code>fread()</code> actually is it compared to <code>read.csv</code>. You can also write a file using <code>fwrite()</code> in <code>data.table</code> like <code>write.csv</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a large .csv file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">28</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>trial <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">10000000</span>), <span class="at">nrow=</span><span class="dv">1000000</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(trial, &#39;trial.csv&#39;, row.names = F)</span></span></code></pre></div>
<p>We can then see that <code>fread()</code> is at least 20 times faster! Let’s check it out!</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken by read.csv to import</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({trial_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;trial.csv&#39;</span>)})</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   39.01    0.94   40.31</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken by fread to import</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({trial_df <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&#39;trial.csv&#39;</span>)})</span></code></pre></div>
<pre><code>##    user  system elapsed 
##    0.44    0.07    0.11</code></pre>
</div>
<div id="creating-data-tables" class="section level2">
<h2>Creating data tables</h2>
<p>To highlight what a data table is, we will create data tables using different functions and compare the results with a data frame. Let’s use a built-in R data called <code>airquality</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Ozone"],"name":[1],"type":["int"],"align":["right"]},{"label":["Solar.R"],"name":[2],"type":["int"],"align":["right"]},{"label":["Wind"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Temp"],"name":[4],"type":["int"],"align":["right"]},{"label":["Month"],"name":[5],"type":["int"],"align":["right"]},{"label":["Day"],"name":[6],"type":["int"],"align":["right"]}],"data":[{"1":"41","2":"190","3":"7.4","4":"67","5":"5","6":"1","_rn_":"1"},{"1":"36","2":"118","3":"8.0","4":"72","5":"5","6":"2","_rn_":"2"},{"1":"12","2":"149","3":"12.6","4":"74","5":"5","6":"3","_rn_":"3"},{"1":"18","2":"313","3":"11.5","4":"62","5":"5","6":"4","_rn_":"4"},{"1":"NA","2":"NA","3":"14.3","4":"56","5":"5","6":"5","_rn_":"5"},{"1":"28","2":"NA","3":"14.9","4":"66","5":"5","6":"6","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airquality)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>To convert this data frame to a data table, we can either use:</p>
<ul>
<li><p><code>data.table()</code> and <code>as.data.table()</code> - This function creates a copy of the data and converts it to a data.table</p></li>
<li><p><code>setDT()</code> - This function converts the data to a data.table, there is then no need to assign to a new object</p></li>
</ul>
<p>We convert <code>airquality</code> data frame to a data table using <code>as.data.table</code>. It then becomes both a data table and a data frame.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airquality)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>airqualityDT <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(airquality)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airqualityDT)</span></code></pre></div>
<pre><code>## [1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<p>Now, we do the same for the <code>mt</code> data frame.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mt <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">fread</span>(<span class="st">&quot;mtcars.csv&quot;</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mt)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setDT</span>(mt) <span class="co"># we do not need to assign mt to a new object</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mt)</span></code></pre></div>
<pre><code>## [1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for illustration purposes, let&#39;s use `as.data.table` and assign it to mtDT</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mtDT <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(mt)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mtDT)</span></code></pre></div>
<pre><code>## [1] &quot;data.table&quot; &quot;data.frame&quot;</code></pre>
<p>We can “manually” create a data table using <code>data.table()</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="fu">round</span>(pi<span class="sc">*</span><span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="dv">2</span>),</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">z =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(DT)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="left">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">3.14</td>
<td align="left">a</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">6.28</td>
<td align="left">b</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">9.42</td>
<td align="left">c</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">12.57</td>
<td align="left">d</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">15.71</td>
<td align="left">e</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">18.85</td>
<td align="left">f</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">21.99</td>
<td align="left">g</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">25.13</td>
<td align="left">h</td>
</tr>
</tbody>
</table>
<p>Packages and functions that work with data frames also work for data tables. Since a data.table is a data.frame, it is compatible with R functions and packages that accept only data.frames.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtDT)</span></code></pre></div>
<pre><code>##  [1] &quot;carname&quot; &quot;mpg&quot;     &quot;cyl&quot;     &quot;disp&quot;    &quot;hp&quot;      &quot;drat&quot;    &quot;wt&quot;     
##  [8] &quot;qsec&quot;    &quot;vs&quot;      &quot;am&quot;      &quot;gear&quot;    &quot;carb&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(mtDT)</span></code></pre></div>
<pre><code>## [1] 32 12</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mtDT)</span></code></pre></div>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   32 obs. of  12 variables:
##  $ carname: chr  &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##  $ mpg    : num  4.58 4.58 4.77 4.63 4.32 ...
##  $ cyl    : int  6 6 4 6 8 6 8 4 4 6 ...
##  $ disp   : num  160 160 108 258 360 ...
##  $ hp     : int  110 110 93 110 175 105 245 62 95 123 ...
##  $ drat   : num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##  $ wt     : num  2.62 2.88 2.32 3.21 3.44 ...
##  $ qsec   : num  16.5 17 18.6 19.4 17 ...
##  $ vs     : int  0 0 1 1 0 1 0 1 1 1 ...
##  $ am     : int  1 1 1 0 0 0 0 0 0 0 ...
##  $ gear   : int  4 4 4 3 3 3 3 4 4 4 ...
##  $ carb   : int  4 4 1 1 2 1 4 2 2 4 ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p>For reference, the <code>mt</code> data has the following variables:</p>
<ul>
<li>[, 1] <strong>carname</strong> - Car name</li>
<li>[, 2] <strong>mpg</strong> - Miles/(US) gallon</li>
<li>[, 3] <strong>cyl</strong> - Number of cylinders</li>
<li>[, 4] <strong>disp</strong> - Displacement (cu.in.)</li>
<li>[, 5] <strong>hp</strong> - Gross horsepower</li>
<li>[, 6] <strong>drat</strong> - Rear axle ratio</li>
<li>[, 7] <strong>wt</strong> - Weight (1000 lbs)</li>
<li>[, 8] <strong>qsec</strong> - 1/4 mile time</li>
<li>[, 9] <strong>vs</strong> - Engine (0 = V-shaped, 1 = straight)</li>
<li>[,10] <strong>am</strong> - Transmission (0 = automatic, 1 = manual)</li>
<li>[,11] <strong>gear</strong> - Number of forward gears</li>
<li>[,12] <strong>carb</strong> - Number of carburetors</li>
</ul>
</div>
</div>
<div id="data-manipulation" class="section level1">
<h1>Data manipulation 🚗</h1>
<p>When compared to a data frame, the basic arguments within brackets are <strong>NOT</strong> row and column numbers but rather “i”, “j” and “by”.</p>
<p>For example, a data table named DT, DT[i, j, by] translates to “Take DT, subset rows using <strong>i</strong>, then calculate <strong>j</strong> grouped by <strong>by</strong>”.</p>
<p>Use data.table subset [ operator the same way you would use data.frame one, but…</p>
<ul>
<li>no need to prefix each column with DT$ (like subset() and with() but built-in)</li>
<li>any R expression using any package is allowed in j argument, not just list of columns</li>
<li>extra argument by to compute j expression by group</li>
</ul>
<p><img src="pics/data_table_syntax.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Let’s compare filtering using conditional statements in a data frame vs. in a data table. You will notice one of the primary benefits of data table, you only need to pass the column names!</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mt[mt<span class="sc">$</span>cyl <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span> mt<span class="sc">$</span>gear <span class="sc">==</span> <span class="dv">4</span>, ]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"},{"1":"Merc 280","2":"4.381780","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.30","9":"1","10":"0","11":"4","12":"4"},{"1":"Merc 280C","2":"4.219005","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.90","9":"1","10":"0","11":"4","12":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># datatable syntax</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mtDT[cyl<span class="sc">==</span><span class="dv">6</span> <span class="sc">&amp;</span> gear<span class="sc">==</span><span class="dv">4</span>, ]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"},{"1":"Merc 280","2":"4.381780","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.30","9":"1","10":"0","11":"4","12":"4"},{"1":"Merc 280C","2":"4.219005","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.90","9":"1","10":"0","11":"4","12":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div id="filtering-rows" class="section level2">
<h2>Filtering rows</h2>
<p>Selecting rows is largely similar to data frame.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select a row</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>,]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160","5":"110","6":"3.9","7":"2.62","8":"16.46","9":"0","10":"1","11":"4","12":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting first five rows</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160","5":"110","6":"3.90","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160","5":"110","6":"3.90","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"},{"1":"Datsun 710","2":"4.774935","3":"4","4":"108","5":"93","6":"3.85","7":"2.320","8":"18.61","9":"1","10":"1","11":"4","12":"1"},{"1":"Hornet 4 Drive","2":"4.626013","3":"6","4":"258","5":"110","6":"3.08","7":"3.215","8":"19.44","9":"1","10":"0","11":"3","12":"1"},{"1":"Hornet Sportabout","2":"4.324350","3":"8","4":"360","5":"175","6":"3.15","7":"3.440","8":"17.02","9":"0","10":"0","11":"3","12":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># no need to put comma in selecting rows</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160","5":"110","6":"3.9","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160","5":"110","6":"3.9","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subsetting using conditional statements</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mtDT[cyl <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> am <span class="sc">==</span> <span class="dv">0</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Merc 240D","2":"4.939636","3":"4","4":"146.7","5":"62","6":"3.69","7":"3.190","8":"20.00","9":"1","10":"0","11":"4","12":"2"},{"1":"Merc 230","2":"4.774935","3":"4","4":"140.8","5":"95","6":"3.92","7":"3.150","8":"22.90","9":"1","10":"0","11":"4","12":"2"},{"1":"Toyota Corona","2":"4.636809","3":"4","4":"120.1","5":"97","6":"3.70","7":"2.465","8":"20.01","9":"1","10":"0","11":"3","12":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mtDT[cyl <span class="sc">%between%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>)] <span class="co"># conditions a range of values</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160.0","5":"110","6":"3.90","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"},{"1":"Hornet 4 Drive","2":"4.626013","3":"6","4":"258.0","5":"110","6":"3.08","7":"3.215","8":"19.44","9":"1","10":"0","11":"3","12":"1"},{"1":"Hornet Sportabout","2":"4.324350","3":"8","4":"360.0","5":"175","6":"3.15","7":"3.440","8":"17.02","9":"0","10":"0","11":"3","12":"2"},{"1":"Valiant","2":"4.254409","3":"6","4":"225.0","5":"105","6":"2.76","7":"3.460","8":"20.22","9":"1","10":"0","11":"3","12":"1"},{"1":"Duster 360","2":"3.781534","3":"8","4":"360.0","5":"245","6":"3.21","7":"3.570","8":"15.84","9":"0","10":"0","11":"3","12":"4"},{"1":"Merc 280","2":"4.381780","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.30","9":"1","10":"0","11":"4","12":"4"},{"1":"Merc 280C","2":"4.219005","3":"6","4":"167.6","5":"123","6":"3.92","7":"3.440","8":"18.90","9":"1","10":"0","11":"4","12":"4"},{"1":"Merc 450SE","2":"4.049691","3":"8","4":"275.8","5":"180","6":"3.07","7":"4.070","8":"17.40","9":"0","10":"0","11":"3","12":"3"},{"1":"Merc 450SL","2":"4.159327","3":"8","4":"275.8","5":"180","6":"3.07","7":"3.730","8":"17.60","9":"0","10":"0","11":"3","12":"3"},{"1":"Merc 450SLC","2":"3.898718","3":"8","4":"275.8","5":"180","6":"3.07","7":"3.780","8":"18.00","9":"0","10":"0","11":"3","12":"3"},{"1":"Cadillac Fleetwood","2":"3.224903","3":"8","4":"472.0","5":"205","6":"2.93","7":"5.250","8":"17.98","9":"0","10":"0","11":"3","12":"4"},{"1":"Lincoln Continental","2":"3.224903","3":"8","4":"460.0","5":"215","6":"3.00","7":"5.424","8":"17.82","9":"0","10":"0","11":"3","12":"4"},{"1":"Chrysler Imperial","2":"3.834058","3":"8","4":"440.0","5":"230","6":"3.23","7":"5.345","8":"17.42","9":"0","10":"0","11":"3","12":"4"},{"1":"Dodge Challenger","2":"3.937004","3":"8","4":"318.0","5":"150","6":"2.76","7":"3.520","8":"16.87","9":"0","10":"0","11":"3","12":"2"},{"1":"AMC Javelin","2":"3.898718","3":"8","4":"304.0","5":"150","6":"3.15","7":"3.435","8":"17.30","9":"0","10":"0","11":"3","12":"2"},{"1":"Camaro Z28","2":"3.646917","3":"8","4":"350.0","5":"245","6":"3.73","7":"3.840","8":"15.41","9":"0","10":"0","11":"3","12":"4"},{"1":"Pontiac Firebird","2":"4.381780","3":"8","4":"400.0","5":"175","6":"3.08","7":"3.845","8":"17.05","9":"0","10":"0","11":"3","12":"2"},{"1":"Ford Pantera L","2":"3.974921","3":"8","4":"351.0","5":"264","6":"4.22","7":"3.170","8":"14.50","9":"0","10":"1","11":"5","12":"4"},{"1":"Ferrari Dino","2":"4.438468","3":"6","4":"145.0","5":"175","6":"3.62","7":"2.770","8":"15.50","9":"0","10":"1","11":"5","12":"6"},{"1":"Maserati Bora","2":"3.872983","3":"8","4":"301.0","5":"335","6":"3.54","7":"3.570","8":"14.60","9":"0","10":"1","11":"5","12":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mtDT[carname <span class="sc">%like%</span> <span class="st">&quot;Mazda&quot;</span>] <span class="co"># finds a pattern</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["disp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[5],"type":["int"],"align":["right"]},{"label":["drat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[9],"type":["int"],"align":["right"]},{"label":["am"],"name":[10],"type":["int"],"align":["right"]},{"label":["gear"],"name":[11],"type":["int"],"align":["right"]},{"label":["carb"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576","3":"6","4":"160","5":"110","6":"3.9","7":"2.620","8":"16.46","9":"0","10":"1","11":"4","12":"4"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"160","5":"110","6":"3.9","7":"2.875","8":"17.02","9":"0","10":"1","11":"4","12":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="selecting-columns" class="section level2">
<h2>Selecting columns</h2>
<p>There are some pointers you have to remember to select a column.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using index</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>mtDT[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"4.582576"},{"1":"Mazda RX4 Wag","2":"4.582576"},{"1":"Datsun 710","2":"4.774935"},{"1":"Hornet 4 Drive","2":"4.626013"},{"1":"Hornet Sportabout","2":"4.324350"},{"1":"Valiant","2":"4.254409"},{"1":"Duster 360","2":"3.781534"},{"1":"Merc 240D","2":"4.939636"},{"1":"Merc 230","2":"4.774935"},{"1":"Merc 280","2":"4.381780"},{"1":"Merc 280C","2":"4.219005"},{"1":"Merc 450SE","2":"4.049691"},{"1":"Merc 450SL","2":"4.159327"},{"1":"Merc 450SLC","2":"3.898718"},{"1":"Cadillac Fleetwood","2":"3.224903"},{"1":"Lincoln Continental","2":"3.224903"},{"1":"Chrysler Imperial","2":"3.834058"},{"1":"Fiat 128","2":"5.692100"},{"1":"Honda Civic","2":"5.513620"},{"1":"Toyota Corolla","2":"5.822371"},{"1":"Toyota Corona","2":"4.636809"},{"1":"Dodge Challenger","2":"3.937004"},{"1":"AMC Javelin","2":"3.898718"},{"1":"Camaro Z28","2":"3.646917"},{"1":"Pontiac Firebird","2":"4.381780"},{"1":"Fiat X1-9","2":"5.224940"},{"1":"Porsche 914-2","2":"5.099020"},{"1":"Lotus Europa","2":"5.513620"},{"1":"Ford Pantera L","2":"3.974921"},{"1":"Ferrari Dino","2":"4.438468"},{"1":"Maserati Bora","2":"3.872983"},{"1":"Volvo 142E","2":"4.626013"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using column name</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>mtDT[ , mpg] <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code>##  [1] 4.582576 4.582576 4.774935 4.626013 4.324350 4.254409 3.781534 4.939636
##  [9] 4.774935 4.381780 4.219005 4.049691 4.159327 3.898718 3.224903 3.224903
## [17] 3.834058 5.692100 5.513620 5.822371 4.636809 3.937004 3.898718 3.646917
## [25] 4.381780 5.224940 5.099020 5.513620 3.974921 4.438468 3.872983 4.626013</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mtDT[ , <span class="st">&quot;mpg&quot;</span>] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.582576"},{"1":"4.582576"},{"1":"4.774935"},{"1":"4.626013"},{"1":"4.324350"},{"1":"4.254409"},{"1":"3.781534"},{"1":"4.939636"},{"1":"4.774935"},{"1":"4.381780"},{"1":"4.219005"},{"1":"4.049691"},{"1":"4.159327"},{"1":"3.898718"},{"1":"3.224903"},{"1":"3.224903"},{"1":"3.834058"},{"1":"5.692100"},{"1":"5.513620"},{"1":"5.822371"},{"1":"4.636809"},{"1":"3.937004"},{"1":"3.898718"},{"1":"3.646917"},{"1":"4.381780"},{"1":"5.224940"},{"1":"5.099020"},{"1":"5.513620"},{"1":"3.974921"},{"1":"4.438468"},{"1":"3.872983"},{"1":"4.626013"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting multiple columns using &quot;list&quot; or puting inside &quot;.()&quot;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>mtDT[, <span class="fu">list</span>(mpg, cyl)]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"4.582576","2":"6"},{"1":"4.582576","2":"6"},{"1":"4.774935","2":"4"},{"1":"4.626013","2":"6"},{"1":"4.324350","2":"8"},{"1":"4.254409","2":"6"},{"1":"3.781534","2":"8"},{"1":"4.939636","2":"4"},{"1":"4.774935","2":"4"},{"1":"4.381780","2":"6"},{"1":"4.219005","2":"6"},{"1":"4.049691","2":"8"},{"1":"4.159327","2":"8"},{"1":"3.898718","2":"8"},{"1":"3.224903","2":"8"},{"1":"3.224903","2":"8"},{"1":"3.834058","2":"8"},{"1":"5.692100","2":"4"},{"1":"5.513620","2":"4"},{"1":"5.822371","2":"4"},{"1":"4.636809","2":"4"},{"1":"3.937004","2":"8"},{"1":"3.898718","2":"8"},{"1":"3.646917","2":"8"},{"1":"4.381780","2":"8"},{"1":"5.224940","2":"4"},{"1":"5.099020","2":"4"},{"1":"5.513620","2":"4"},{"1":"3.974921","2":"8"},{"1":"4.438468","2":"6"},{"1":"3.872983","2":"8"},{"1":"4.626013","2":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>mtDT[, .(mpg, cyl)]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"4.582576","2":"6"},{"1":"4.582576","2":"6"},{"1":"4.774935","2":"4"},{"1":"4.626013","2":"6"},{"1":"4.324350","2":"8"},{"1":"4.254409","2":"6"},{"1":"3.781534","2":"8"},{"1":"4.939636","2":"4"},{"1":"4.774935","2":"4"},{"1":"4.381780","2":"6"},{"1":"4.219005","2":"6"},{"1":"4.049691","2":"8"},{"1":"4.159327","2":"8"},{"1":"3.898718","2":"8"},{"1":"3.224903","2":"8"},{"1":"3.224903","2":"8"},{"1":"3.834058","2":"8"},{"1":"5.692100","2":"4"},{"1":"5.513620","2":"4"},{"1":"5.822371","2":"4"},{"1":"4.636809","2":"4"},{"1":"3.937004","2":"8"},{"1":"3.898718","2":"8"},{"1":"3.646917","2":"8"},{"1":"4.381780","2":"8"},{"1":"5.224940","2":"4"},{"1":"5.099020","2":"4"},{"1":"5.513620","2":"4"},{"1":"3.974921","2":"8"},{"1":"4.438468","2":"6"},{"1":"3.872983","2":"8"},{"1":"4.626013","2":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting multiple columns using a character vector</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg&#39;</span>, <span class="st">&#39;cyl&#39;</span>, <span class="st">&#39;disp&#39;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co">#mtDT[, col] # returns an error</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># need to put, with = FALSE, or add &quot;..&quot; before the character vector</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>mtDT[, col, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.582576","2":"6","3":"160.0"},{"1":"4.582576","2":"6","3":"160.0"},{"1":"4.774935","2":"4","3":"108.0"},{"1":"4.626013","2":"6","3":"258.0"},{"1":"4.324350","2":"8","3":"360.0"},{"1":"4.254409","2":"6","3":"225.0"},{"1":"3.781534","2":"8","3":"360.0"},{"1":"4.939636","2":"4","3":"146.7"},{"1":"4.774935","2":"4","3":"140.8"},{"1":"4.381780","2":"6","3":"167.6"},{"1":"4.219005","2":"6","3":"167.6"},{"1":"4.049691","2":"8","3":"275.8"},{"1":"4.159327","2":"8","3":"275.8"},{"1":"3.898718","2":"8","3":"275.8"},{"1":"3.224903","2":"8","3":"472.0"},{"1":"3.224903","2":"8","3":"460.0"},{"1":"3.834058","2":"8","3":"440.0"},{"1":"5.692100","2":"4","3":"78.7"},{"1":"5.513620","2":"4","3":"75.7"},{"1":"5.822371","2":"4","3":"71.1"},{"1":"4.636809","2":"4","3":"120.1"},{"1":"3.937004","2":"8","3":"318.0"},{"1":"3.898718","2":"8","3":"304.0"},{"1":"3.646917","2":"8","3":"350.0"},{"1":"4.381780","2":"8","3":"400.0"},{"1":"5.224940","2":"4","3":"79.0"},{"1":"5.099020","2":"4","3":"120.3"},{"1":"5.513620","2":"4","3":"95.1"},{"1":"3.974921","2":"8","3":"351.0"},{"1":"4.438468","2":"6","3":"145.0"},{"1":"3.872983","2":"8","3":"301.0"},{"1":"4.626013","2":"4","3":"121.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mtDT[, ..col]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.582576","2":"6","3":"160.0"},{"1":"4.582576","2":"6","3":"160.0"},{"1":"4.774935","2":"4","3":"108.0"},{"1":"4.626013","2":"6","3":"258.0"},{"1":"4.324350","2":"8","3":"360.0"},{"1":"4.254409","2":"6","3":"225.0"},{"1":"3.781534","2":"8","3":"360.0"},{"1":"4.939636","2":"4","3":"146.7"},{"1":"4.774935","2":"4","3":"140.8"},{"1":"4.381780","2":"6","3":"167.6"},{"1":"4.219005","2":"6","3":"167.6"},{"1":"4.049691","2":"8","3":"275.8"},{"1":"4.159327","2":"8","3":"275.8"},{"1":"3.898718","2":"8","3":"275.8"},{"1":"3.224903","2":"8","3":"472.0"},{"1":"3.224903","2":"8","3":"460.0"},{"1":"3.834058","2":"8","3":"440.0"},{"1":"5.692100","2":"4","3":"78.7"},{"1":"5.513620","2":"4","3":"75.7"},{"1":"5.822371","2":"4","3":"71.1"},{"1":"4.636809","2":"4","3":"120.1"},{"1":"3.937004","2":"8","3":"318.0"},{"1":"3.898718","2":"8","3":"304.0"},{"1":"3.646917","2":"8","3":"350.0"},{"1":"4.381780","2":"8","3":"400.0"},{"1":"5.224940","2":"4","3":"79.0"},{"1":"5.099020","2":"4","3":"120.3"},{"1":"5.513620","2":"4","3":"95.1"},{"1":"3.974921","2":"8","3":"351.0"},{"1":"4.438468","2":"6","3":"145.0"},{"1":"3.872983","2":"8","3":"301.0"},{"1":"4.626013","2":"4","3":"121.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="subsetting-rows-and-columns" class="section level2">
<h2>Subsetting rows and columns</h2>
<p>Combing what we learned above, we can filter rows and select columns together from a data table.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting first row, second column</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"4.582576"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>,cyl] <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>,<span class="st">&quot;cyl&quot;</span>] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>,<span class="fu">list</span>(mpg, cyl)] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"4.582576","2":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>, .(mpg, cyl)] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"4.582576","2":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mtDT[<span class="dv">1</span>, <span class="fu">c</span>(mpg, cyl)] <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code>## [1] 4.582576 6.000000</code></pre>
</div>
</div>
<div id="modifying-variables" class="section level1">
<h1>Modifying variables 🔑</h1>
<p>Data.table also makes it easy to:</p>
<ul>
<li>Drop columns;</li>
<li>Rename columns; and</li>
<li>Assign and save new variables.</li>
</ul>
<div id="dropping-columns" class="section level2">
<h2>Dropping columns</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;mpg&#39;</span>, <span class="st">&#39;cyl&#39;</span>, <span class="st">&#39;disp&#39;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>mtDT[, <span class="sc">!</span>col, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["hp"],"name":[2],"type":["int"],"align":["right"]},{"label":["drat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[6],"type":["int"],"align":["right"]},{"label":["am"],"name":[7],"type":["int"],"align":["right"]},{"label":["gear"],"name":[8],"type":["int"],"align":["right"]},{"label":["carb"],"name":[9],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"110","3":"3.90","4":"2.620","5":"16.46","6":"0","7":"1","8":"4","9":"4"},{"1":"Mazda RX4 Wag","2":"110","3":"3.90","4":"2.875","5":"17.02","6":"0","7":"1","8":"4","9":"4"},{"1":"Datsun 710","2":"93","3":"3.85","4":"2.320","5":"18.61","6":"1","7":"1","8":"4","9":"1"},{"1":"Hornet 4 Drive","2":"110","3":"3.08","4":"3.215","5":"19.44","6":"1","7":"0","8":"3","9":"1"},{"1":"Hornet Sportabout","2":"175","3":"3.15","4":"3.440","5":"17.02","6":"0","7":"0","8":"3","9":"2"},{"1":"Valiant","2":"105","3":"2.76","4":"3.460","5":"20.22","6":"1","7":"0","8":"3","9":"1"},{"1":"Duster 360","2":"245","3":"3.21","4":"3.570","5":"15.84","6":"0","7":"0","8":"3","9":"4"},{"1":"Merc 240D","2":"62","3":"3.69","4":"3.190","5":"20.00","6":"1","7":"0","8":"4","9":"2"},{"1":"Merc 230","2":"95","3":"3.92","4":"3.150","5":"22.90","6":"1","7":"0","8":"4","9":"2"},{"1":"Merc 280","2":"123","3":"3.92","4":"3.440","5":"18.30","6":"1","7":"0","8":"4","9":"4"},{"1":"Merc 280C","2":"123","3":"3.92","4":"3.440","5":"18.90","6":"1","7":"0","8":"4","9":"4"},{"1":"Merc 450SE","2":"180","3":"3.07","4":"4.070","5":"17.40","6":"0","7":"0","8":"3","9":"3"},{"1":"Merc 450SL","2":"180","3":"3.07","4":"3.730","5":"17.60","6":"0","7":"0","8":"3","9":"3"},{"1":"Merc 450SLC","2":"180","3":"3.07","4":"3.780","5":"18.00","6":"0","7":"0","8":"3","9":"3"},{"1":"Cadillac Fleetwood","2":"205","3":"2.93","4":"5.250","5":"17.98","6":"0","7":"0","8":"3","9":"4"},{"1":"Lincoln Continental","2":"215","3":"3.00","4":"5.424","5":"17.82","6":"0","7":"0","8":"3","9":"4"},{"1":"Chrysler Imperial","2":"230","3":"3.23","4":"5.345","5":"17.42","6":"0","7":"0","8":"3","9":"4"},{"1":"Fiat 128","2":"66","3":"4.08","4":"2.200","5":"19.47","6":"1","7":"1","8":"4","9":"1"},{"1":"Honda Civic","2":"52","3":"4.93","4":"1.615","5":"18.52","6":"1","7":"1","8":"4","9":"2"},{"1":"Toyota Corolla","2":"65","3":"4.22","4":"1.835","5":"19.90","6":"1","7":"1","8":"4","9":"1"},{"1":"Toyota Corona","2":"97","3":"3.70","4":"2.465","5":"20.01","6":"1","7":"0","8":"3","9":"1"},{"1":"Dodge Challenger","2":"150","3":"2.76","4":"3.520","5":"16.87","6":"0","7":"0","8":"3","9":"2"},{"1":"AMC Javelin","2":"150","3":"3.15","4":"3.435","5":"17.30","6":"0","7":"0","8":"3","9":"2"},{"1":"Camaro Z28","2":"245","3":"3.73","4":"3.840","5":"15.41","6":"0","7":"0","8":"3","9":"4"},{"1":"Pontiac Firebird","2":"175","3":"3.08","4":"3.845","5":"17.05","6":"0","7":"0","8":"3","9":"2"},{"1":"Fiat X1-9","2":"66","3":"4.08","4":"1.935","5":"18.90","6":"1","7":"1","8":"4","9":"1"},{"1":"Porsche 914-2","2":"91","3":"4.43","4":"2.140","5":"16.70","6":"0","7":"1","8":"5","9":"2"},{"1":"Lotus Europa","2":"113","3":"3.77","4":"1.513","5":"16.90","6":"1","7":"1","8":"5","9":"2"},{"1":"Ford Pantera L","2":"264","3":"4.22","4":"3.170","5":"14.50","6":"0","7":"1","8":"5","9":"4"},{"1":"Ferrari Dino","2":"175","3":"3.62","4":"2.770","5":"15.50","6":"0","7":"1","8":"5","9":"6"},{"1":"Maserati Bora","2":"335","3":"3.54","4":"3.570","5":"14.60","6":"0","7":"1","8":"5","9":"8"},{"1":"Volvo 142E","2":"109","3":"4.11","4":"2.780","5":"18.60","6":"1","7":"1","8":"4","9":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mtDT[, <span class="sc">!</span>..col] </span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["hp"],"name":[2],"type":["int"],"align":["right"]},{"label":["drat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[6],"type":["int"],"align":["right"]},{"label":["am"],"name":[7],"type":["int"],"align":["right"]},{"label":["gear"],"name":[8],"type":["int"],"align":["right"]},{"label":["carb"],"name":[9],"type":["int"],"align":["right"]}],"data":[{"1":"Mazda RX4","2":"110","3":"3.90","4":"2.620","5":"16.46","6":"0","7":"1","8":"4","9":"4"},{"1":"Mazda RX4 Wag","2":"110","3":"3.90","4":"2.875","5":"17.02","6":"0","7":"1","8":"4","9":"4"},{"1":"Datsun 710","2":"93","3":"3.85","4":"2.320","5":"18.61","6":"1","7":"1","8":"4","9":"1"},{"1":"Hornet 4 Drive","2":"110","3":"3.08","4":"3.215","5":"19.44","6":"1","7":"0","8":"3","9":"1"},{"1":"Hornet Sportabout","2":"175","3":"3.15","4":"3.440","5":"17.02","6":"0","7":"0","8":"3","9":"2"},{"1":"Valiant","2":"105","3":"2.76","4":"3.460","5":"20.22","6":"1","7":"0","8":"3","9":"1"},{"1":"Duster 360","2":"245","3":"3.21","4":"3.570","5":"15.84","6":"0","7":"0","8":"3","9":"4"},{"1":"Merc 240D","2":"62","3":"3.69","4":"3.190","5":"20.00","6":"1","7":"0","8":"4","9":"2"},{"1":"Merc 230","2":"95","3":"3.92","4":"3.150","5":"22.90","6":"1","7":"0","8":"4","9":"2"},{"1":"Merc 280","2":"123","3":"3.92","4":"3.440","5":"18.30","6":"1","7":"0","8":"4","9":"4"},{"1":"Merc 280C","2":"123","3":"3.92","4":"3.440","5":"18.90","6":"1","7":"0","8":"4","9":"4"},{"1":"Merc 450SE","2":"180","3":"3.07","4":"4.070","5":"17.40","6":"0","7":"0","8":"3","9":"3"},{"1":"Merc 450SL","2":"180","3":"3.07","4":"3.730","5":"17.60","6":"0","7":"0","8":"3","9":"3"},{"1":"Merc 450SLC","2":"180","3":"3.07","4":"3.780","5":"18.00","6":"0","7":"0","8":"3","9":"3"},{"1":"Cadillac Fleetwood","2":"205","3":"2.93","4":"5.250","5":"17.98","6":"0","7":"0","8":"3","9":"4"},{"1":"Lincoln Continental","2":"215","3":"3.00","4":"5.424","5":"17.82","6":"0","7":"0","8":"3","9":"4"},{"1":"Chrysler Imperial","2":"230","3":"3.23","4":"5.345","5":"17.42","6":"0","7":"0","8":"3","9":"4"},{"1":"Fiat 128","2":"66","3":"4.08","4":"2.200","5":"19.47","6":"1","7":"1","8":"4","9":"1"},{"1":"Honda Civic","2":"52","3":"4.93","4":"1.615","5":"18.52","6":"1","7":"1","8":"4","9":"2"},{"1":"Toyota Corolla","2":"65","3":"4.22","4":"1.835","5":"19.90","6":"1","7":"1","8":"4","9":"1"},{"1":"Toyota Corona","2":"97","3":"3.70","4":"2.465","5":"20.01","6":"1","7":"0","8":"3","9":"1"},{"1":"Dodge Challenger","2":"150","3":"2.76","4":"3.520","5":"16.87","6":"0","7":"0","8":"3","9":"2"},{"1":"AMC Javelin","2":"150","3":"3.15","4":"3.435","5":"17.30","6":"0","7":"0","8":"3","9":"2"},{"1":"Camaro Z28","2":"245","3":"3.73","4":"3.840","5":"15.41","6":"0","7":"0","8":"3","9":"4"},{"1":"Pontiac Firebird","2":"175","3":"3.08","4":"3.845","5":"17.05","6":"0","7":"0","8":"3","9":"2"},{"1":"Fiat X1-9","2":"66","3":"4.08","4":"1.935","5":"18.90","6":"1","7":"1","8":"4","9":"1"},{"1":"Porsche 914-2","2":"91","3":"4.43","4":"2.140","5":"16.70","6":"0","7":"1","8":"5","9":"2"},{"1":"Lotus Europa","2":"113","3":"3.77","4":"1.513","5":"16.90","6":"1","7":"1","8":"5","9":"2"},{"1":"Ford Pantera L","2":"264","3":"4.22","4":"3.170","5":"14.50","6":"0","7":"1","8":"5","9":"4"},{"1":"Ferrari Dino","2":"175","3":"3.62","4":"2.770","5":"15.50","6":"0","7":"1","8":"5","9":"6"},{"1":"Maserati Bora","2":"335","3":"3.54","4":"3.570","5":"14.60","6":"0","7":"1","8":"5","9":"8"},{"1":"Volvo 142E","2":"109","3":"4.11","4":"2.780","5":"18.60","6":"1","7":"1","8":"4","9":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note: you need to assign this to a new object to make a new data table excluding the dropped variables</span></span></code></pre></div>
</div>
<div id="renaming-columns-using-setnames" class="section level2">
<h2>Renaming columns using <code>setnames()</code></h2>
<p><code>setnames()</code> in data.table changes the names of a data table by reference.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(mtDT, <span class="st">&#39;vs&#39;</span>, <span class="st">&#39;engine_type&#39;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtDT) <span class="co"># vs renamed to engine_type</span></span></code></pre></div>
<pre><code>##  [1] &quot;carname&quot;     &quot;mpg&quot;         &quot;cyl&quot;         &quot;disp&quot;        &quot;hp&quot;         
##  [6] &quot;drat&quot;        &quot;wt&quot;          &quot;qsec&quot;        &quot;engine_type&quot; &quot;am&quot;         
## [11] &quot;gear&quot;        &quot;carb&quot;</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(mtDT,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="fu">c</span>(<span class="st">&quot;horse_power&quot;</span>,<span class="st">&quot;rear_ratio&quot;</span>))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtDT)</span></code></pre></div>
<pre><code>##  [1] &quot;carname&quot;     &quot;mpg&quot;         &quot;cyl&quot;         &quot;disp&quot;        &quot;horse_power&quot;
##  [6] &quot;rear_ratio&quot;  &quot;wt&quot;          &quot;qsec&quot;        &quot;engine_type&quot; &quot;am&quot;         
## [11] &quot;gear&quot;        &quot;carb&quot;</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setnames</span>(mtDT,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>,<span class="fu">c</span>(<span class="st">&quot;hp&quot;</span>,<span class="st">&quot;drat&quot;</span>))</span></code></pre></div>
</div>
<div id="assigning-and-saving-new-variables" class="section level2">
<h2>Assigning and saving new variables</h2>
<p>To create a new column, we use this symbol <code>:=</code> to assign the new variable.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mtDT[, cyl_gear <span class="sc">:</span><span class="er">=</span> cyl <span class="sc">+</span> gear]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>mtDT[, cyl_gear] <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code>##  [1] 10 10  8  9 11  9 11  8  8 10 10 11 11 11 11 11 11  8  8  8  7 11 11 11 11
## [26]  8  9  9 13 11 13  8</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mtDT[, <span class="st">&quot;cyl_gear&quot;</span>] <span class="co"># returns the column</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl_gear"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"10"},{"1":"10"},{"1":"8"},{"1":"9"},{"1":"11"},{"1":"9"},{"1":"11"},{"1":"8"},{"1":"8"},{"1":"10"},{"1":"10"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"8"},{"1":"8"},{"1":"8"},{"1":"7"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"11"},{"1":"8"},{"1":"9"},{"1":"9"},{"1":"13"},{"1":"11"},{"1":"13"},{"1":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can also create multiple columns like using <code>mutate()</code> in <code>dplyr</code>. In <code>data.table</code>, we only need to put back single quotes to <code>:=</code> and assign new variables.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mtDT[,  <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">cyl_gear2 =</span> cyl <span class="sc">*</span> gear,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">cyl_gear3 =</span> cyl <span class="sc">-</span> gear)]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mtDT)</span></code></pre></div>
<pre><code>##  [1] &quot;carname&quot;     &quot;mpg&quot;         &quot;cyl&quot;         &quot;disp&quot;        &quot;hp&quot;         
##  [6] &quot;drat&quot;        &quot;wt&quot;          &quot;qsec&quot;        &quot;engine_type&quot; &quot;am&quot;         
## [11] &quot;gear&quot;        &quot;carb&quot;        &quot;cyl_gear&quot;    &quot;cyl_gear2&quot;   &quot;cyl_gear3&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtDT[, <span class="fu">list</span>(cyl_gear2, cyl_gear3)])</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl_gear2"],"name":[1],"type":["int"],"align":["right"]},{"label":["cyl_gear3"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"24","2":"2"},{"1":"24","2":"2"},{"1":"16","2":"0"},{"1":"18","2":"3"},{"1":"24","2":"5"},{"1":"18","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="summarizing-data" class="section level1">
<h1>Summarizing data 💻</h1>
<p>Summarising data is more readable and easier to type as it takes fewer key strokes compared to <code>dplyr</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mtDT[,(<span class="at">mean_hp =</span> <span class="fu">mean</span>(hp))] <span class="co"># returns a vector</span></span></code></pre></div>
<pre><code>## [1] 146.6875</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice what happens using &quot;.&quot;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>mtDT[,.(<span class="at">mean_hp =</span> <span class="fu">mean</span>(hp))] <span class="co"># returns name</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean_hp"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"146.6875"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mtDT[,.(<span class="at">mean_hp =</span> <span class="fu">mean</span>(hp), <span class="at">sd_hp =</span> <span class="fu">sd</span>(hp))] <span class="co"># without the &quot;.&quot; at the beggining, you will get an error</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean_hp"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd_hp"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"146.6875","2":"68.56287"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mtDT[,.(<span class="at">mean_hp =</span> <span class="fu">mean</span>(hp), <span class="at">sd_hp =</span> <span class="fu">sd</span>(hp)), by <span class="ot">=</span> .(engine_type)]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["engine_type"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_hp"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd_hp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"189.72222","3":"60.28150"},{"1":"1","2":"91.35714","3":"24.42447"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can remove the . if you&#39;re only grouping using one variable</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>mtDT[,.(<span class="at">mean_hp =</span> <span class="fu">mean</span>(hp), <span class="at">sd_hp =</span> <span class="fu">sd</span>(hp)), by <span class="ot">=</span> engine_type]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["engine_type"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_hp"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd_hp"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"189.72222","3":"60.28150"},{"1":"1","2":"91.35714","3":"24.42447"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can also compute a frequency table by engine type.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mtDT[, .N, engine_type]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["engine_type"],"name":[1],"type":["int"],"align":["right"]},{"label":["N"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"0","2":"18"},{"1":"1","2":"14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="chaining" class="section level1">
<h1>Chaining 📱</h1>
<p>Chaining is like piping in <code>dplyr</code>. We only need to attach square brackets at the end, with the next method, to add an additional step in the analysis. We can do multiple data table operations one after the other without having to store intermediate results.</p>
<p>For example, we want to return the average mpg, disp, wt, qsec. Then, order the results by cyl.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>mtDT[, .(<span class="at">mean_mpg=</span><span class="fu">mean</span>(mpg),</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_disp=</span><span class="fu">mean</span>(disp),</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_wt=</span><span class="fu">mean</span>(wt),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_qsec=</span><span class="fu">mean</span>(qsec)), by<span class="ot">=</span>cyl]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_qsec"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"6","2":"4.440690","3":"183.3143","4":"3.117143","5":"17.97714"},{"1":"4","2":"5.147091","3":"105.1364","4":"2.285727","5":"19.13727"},{"1":"8","2":"3.872129","3":"353.1000","4":"3.999214","5":"16.77214"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>mtDT[, .(<span class="at">mean_mpg=</span><span class="fu">mean</span>(mpg),</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_disp=</span><span class="fu">mean</span>(disp),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_wt=</span><span class="fu">mean</span>(wt),</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_qsec=</span><span class="fu">mean</span>(qsec)), by<span class="ot">=</span>cyl][<span class="fu">order</span>(cyl),]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_qsec"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"5.147091","3":"105.1364","4":"2.285727","5":"19.13727"},{"1":"6","2":"4.440690","3":"183.3143","4":"3.117143","5":"17.97714"},{"1":"8","2":"3.872129","3":"353.1000","4":"3.999214","5":"16.77214"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Recall that the <code>dplyr</code> piping version of this is:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>mtDT <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_mpg=</span><span class="fu">mean</span>(mpg),</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_disp=</span><span class="fu">mean</span>(disp),</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_wt=</span><span class="fu">mean</span>(wt),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_qsec=</span><span class="fu">mean</span>(qsec)) <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cyl)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_qsec"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"5.147091","3":"105.1364","4":"2.285727","5":"19.13727"},{"1":"6","2":"4.440690","3":"183.3143","4":"3.117143","5":"17.97714"},{"1":"8","2":"3.872129","3":"353.1000","4":"3.999214","5":"16.77214"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We can also use piping in data tables and create new variables, x, y, z.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>mtDT[, x <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(mpg)] <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>        .[, y <span class="sc">:</span><span class="er">=</span> gear<span class="sc">^</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>        .[, z <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(carname , <span class="st">&quot;2&quot;</span>)]</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtDT[,x<span class="sc">:</span>z])</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["z"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"2.140695","2":"16","3":"Mazda RX42"},{"1":"2.140695","2":"16","3":"Mazda RX4 Wag2"},{"1":"2.185162","2":"16","3":"Datsun 7102"},{"1":"2.150817","2":"9","3":"Hornet 4 Drive2"},{"1":"2.079507","2":"9","3":"Hornet Sportabout2"},{"1":"2.062622","2":"9","3":"Valiant2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="joins-with-data.table" class="section level1">
<h1>Joins with <code>data.table</code> 👪</h1>
<div id="key" class="section level2">
<h2>Key</h2>
<p>The concept of a “key” is useful in data tables, especially in merging data. We can set a column as a key using <code>setkey()</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(mtDT, carname) <span class="co"># setting carname as key</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(mtDT, carname, cyl) <span class="co"># setting multiple keys</span></span></code></pre></div>
<p>Remember the chaining example a while ago. We grouped and ordered by <code>cyl</code>. Let’s re-do that using a shortcut by using <code>keyby</code>.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of using this chain</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>mtDT[, .(<span class="at">mean_mpg=</span><span class="fu">mean</span>(mpg),</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_disp=</span><span class="fu">mean</span>(disp),</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_wt=</span><span class="fu">mean</span>(wt),</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_qsec=</span><span class="fu">mean</span>(qsec)), by<span class="ot">=</span>cyl][<span class="fu">order</span>(cyl), ]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_qsec"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"5.147091","3":"105.1364","4":"2.285727","5":"19.13727"},{"1":"6","2":"4.440690","3":"183.3143","4":"3.117143","5":"17.97714"},{"1":"8","2":"3.872129","3":"353.1000","4":"3.999214","5":"16.77214"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use keyby to group and order by cyl</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>mtDT[, .(<span class="at">mean_mpg=</span><span class="fu">mean</span>(mpg),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_disp=</span><span class="fu">mean</span>(disp),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_wt=</span><span class="fu">mean</span>(wt),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_qsec=</span><span class="fu">mean</span>(qsec)), keyby<span class="ot">=</span>cyl]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["cyl"],"name":[1],"type":["int"],"align":["right"]},{"label":["mean_mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean_disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean_wt"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["mean_qsec"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"4","2":"5.147091","3":"105.1364","4":"2.285727","5":"19.13727"},{"1":"6","2":"4.440690","3":"183.3143","4":"3.117143","5":"17.97714"},{"1":"8","2":"3.872129","3":"353.1000","4":"3.999214","5":"16.77214"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">key</span>(mtDT)</span></code></pre></div>
<pre><code>## [1] &quot;carname&quot; &quot;cyl&quot;</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(mtDT, <span class="cn">NULL</span>) <span class="co"># to remove the key</span></span></code></pre></div>
</div>
<div id="joining-data-tables" class="section level2">
<h2>Joining data tables</h2>
<p>Now that we know what a key is, we can use this concept to merge or join two data tables.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setkey</span>(mtDT, carname)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we subset 2 data tables from mtDT</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> mtDT[<span class="dv">5</span><span class="sc">:</span><span class="dv">25</span>,.(carname, mpg, cyl)] <span class="co"># 26 rows</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> mtDT[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, .(carname, gear)] <span class="co"># 10 rows</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Inner Join</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(dt1, dt2, <span class="at">by=</span><span class="st">&#39;carname&#39;</span>) <span class="co"># returns 6 rows from row 5 to 10</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["gear"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Datsun 710","2":"4.774935","3":"4","4":"4"},{"1":"Dodge Challenger","2":"3.937004","3":"8","4":"3"},{"1":"Duster 360","2":"3.781534","3":"8","4":"3"},{"1":"Ferrari Dino","2":"4.438468","3":"6","4":"5"},{"1":"Fiat 128","2":"5.692100","3":"4","4":"4"},{"1":"Fiat X1-9","2":"5.224940","3":"4","4":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Left Join</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(dt1, dt2, <span class="at">by=</span><span class="st">&#39;carname&#39;</span>, <span class="at">all.x =</span> T) <span class="co"># returns 21 rows using dt1 as the base</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["gear"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"Datsun 710","2":"4.774935","3":"4","4":"4"},{"1":"Dodge Challenger","2":"3.937004","3":"8","4":"3"},{"1":"Duster 360","2":"3.781534","3":"8","4":"3"},{"1":"Ferrari Dino","2":"4.438468","3":"6","4":"5"},{"1":"Fiat 128","2":"5.692100","3":"4","4":"4"},{"1":"Fiat X1-9","2":"5.224940","3":"4","4":"4"},{"1":"Ford Pantera L","2":"3.974921","3":"8","4":"NA"},{"1":"Honda Civic","2":"5.513620","3":"4","4":"NA"},{"1":"Hornet 4 Drive","2":"4.626013","3":"6","4":"NA"},{"1":"Hornet Sportabout","2":"4.324350","3":"8","4":"NA"},{"1":"Lincoln Continental","2":"3.224903","3":"8","4":"NA"},{"1":"Lotus Europa","2":"5.513620","3":"4","4":"NA"},{"1":"Maserati Bora","2":"3.872983","3":"8","4":"NA"},{"1":"Mazda RX4","2":"4.582576","3":"6","4":"NA"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"NA"},{"1":"Merc 230","2":"4.774935","3":"4","4":"NA"},{"1":"Merc 240D","2":"4.939636","3":"4","4":"NA"},{"1":"Merc 280","2":"4.381780","3":"6","4":"NA"},{"1":"Merc 280C","2":"4.219005","3":"6","4":"NA"},{"1":"Merc 450SE","2":"4.049691","3":"8","4":"NA"},{"1":"Merc 450SL","2":"4.159327","3":"8","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Outer Join</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">merge</span>(dt1, dt2, <span class="at">by=</span><span class="st">&#39;carname&#39;</span>, <span class="at">all =</span> T)  <span class="co"># returns 25 rows</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carname"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mpg"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[3],"type":["int"],"align":["right"]},{"label":["gear"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"AMC Javelin","2":"NA","3":"NA","4":"3"},{"1":"Cadillac Fleetwood","2":"NA","3":"NA","4":"3"},{"1":"Camaro Z28","2":"NA","3":"NA","4":"3"},{"1":"Chrysler Imperial","2":"NA","3":"NA","4":"3"},{"1":"Datsun 710","2":"4.774935","3":"4","4":"4"},{"1":"Dodge Challenger","2":"3.937004","3":"8","4":"3"},{"1":"Duster 360","2":"3.781534","3":"8","4":"3"},{"1":"Ferrari Dino","2":"4.438468","3":"6","4":"5"},{"1":"Fiat 128","2":"5.692100","3":"4","4":"4"},{"1":"Fiat X1-9","2":"5.224940","3":"4","4":"4"},{"1":"Ford Pantera L","2":"3.974921","3":"8","4":"NA"},{"1":"Honda Civic","2":"5.513620","3":"4","4":"NA"},{"1":"Hornet 4 Drive","2":"4.626013","3":"6","4":"NA"},{"1":"Hornet Sportabout","2":"4.324350","3":"8","4":"NA"},{"1":"Lincoln Continental","2":"3.224903","3":"8","4":"NA"},{"1":"Lotus Europa","2":"5.513620","3":"4","4":"NA"},{"1":"Maserati Bora","2":"3.872983","3":"8","4":"NA"},{"1":"Mazda RX4","2":"4.582576","3":"6","4":"NA"},{"1":"Mazda RX4 Wag","2":"4.582576","3":"6","4":"NA"},{"1":"Merc 230","2":"4.774935","3":"4","4":"NA"},{"1":"Merc 240D","2":"4.939636","3":"4","4":"NA"},{"1":"Merc 280","2":"4.381780","3":"6","4":"NA"},{"1":"Merc 280C","2":"4.219005","3":"6","4":"NA"},{"1":"Merc 450SE","2":"4.049691","3":"8","4":"NA"},{"1":"Merc 450SL","2":"4.159327","3":"8","4":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="plotting-data" class="section level1">
<h1>Plotting data 💹</h1>
<p>We can also quickly present a simple scatter plot using data.table.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>mtDT[,<span class="fu">plot</span>(mpg, drat, <span class="at">main=</span><span class="st">&quot;mpg vs. drat&quot;</span>)]</span></code></pre></div>
<p><img src="DataWrangling_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="further-readings" class="section level1">
<h1>Further readings 👨‍🎓</h1>
<p><code>data.table</code> has many other functions including:</p>
<ul>
<li><code>dcast()</code> - pivot/wider/spread</li>
<li><code>melt()</code> - unpivot/longer/gather</li>
</ul>
</div>
<div id="exercise" class="section level1">
<h1>Exercise ☀️</h1>
<p>Using <code>data.table</code> and the <code>mtcars.csv</code> data, please complete the following exercises.</p>
<ol style="list-style-type: upper-alpha">
<li>Please create a new variable called <code>mpg_type</code> that has the value ‘high’ if mpg &gt; 30. If mpg &lt; 30, then the value should be ‘low’.</li>
</ol>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here</span></span></code></pre></div>
<ol start="2" style="list-style-type: upper-alpha">
<li>Please import the <code>mtcars_fun</code> dataset as a data table. Please name this data table <code>mt_fun</code>. Then, merge the <code>mtcars</code> and <code>mtcars_fun</code> data tables as a new data table called <code>mt_merged</code>. Compute the mean and standard deviation of tires variable by transmission variable or am.</li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here</span></span></code></pre></div>
<ol start="3" style="list-style-type: upper-alpha">
<li>Please convert the mpg variable into kilometres per litre and assign it to kpl. The formula for conversion is 1 mpg = 2.352 kpl. Compute for the mean mpg, kpl, drat, then group and sort the results by cyl using <code>keyby</code>()</li>
</ol>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here</span></span></code></pre></div>
</div>
<div id="sources" class="section level1">
<h1>Sources 👨‍🏫</h1>
<p>This tutorial is partly based on <a href="https://www.machinelearningplus.com/data-manipulation/datatable-in-r-complete-guide/">data.table in R – The Complete Beginners Guide</a> by Selva Prabhakaran and <a href="https://towardsdatascience.com/data-wrangling-raw-to-clean-transformation-b30a27bf4b3b">Data Wrangling — Raw to Clean Transformation</a> by Suraj Gurav.</p>
</div>

&nbsp;
<hr />
<p style="text-align: center;">Presentation by Ma. Adelle Gia Arbo & Viraaj Akuthota</a></p>
<p style="text-align: center;"><span style="color: #808080;"><em>Intro to Data Science Workshop Fall 2021</em></span></p>
<p style="text-align: center;"><span style="color: #808080;"><em><a href="https://www.hertie-school.org/en/">Hertie School, Berlin</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" >

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://github.com/intro-to-data-science-21-workshop"  <i class="fab fa-github"></i><a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
